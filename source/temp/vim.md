---
title: Vim 实用技巧
date: 2017-12-15 22:30:00
categories: 读书笔记
tags: [Vim]
---

Vim 是一款功能丰富而强大的文本编辑器，其代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中得到非常广泛的使用。 Vim 能够大大提高程序员的工作效率。对于 Vim 高手来说， Vim 能以与思考同步的速度编辑文本。同时，学习和熟练使用 Vim 又有一定的难度。

先学会盲打，然后再学习 Vim
Vim 的祖先要追溯到经典的 UNIX 编辑器 vi 和 ed，参见技巧 27 中的“ Vim（及其家族） 的词源”部分，它们比鼠标及所有点击界面出现得都早，因此根本没有这类
接口，所有操作都通过键盘完成。 Vim 也是一样， Vim 中的所有操作也都可以通过键盘完成。对盲打人员来说，这意味着用 Vim 做任何事都能更快些。

## Vim 解决问题的方式
技巧 1 认识 . 命令
. 命令可以让我们重复上次的修改，它是 Vim 中最为强大的多面手
. 命令是一个微型的宏，可以录制任意数目的按键操作，然后在以后重复执行它们。
进入插入模式的那一刻起（例如，输入 i），直到返回普通模式时为止（输入 <Esc>）， Vim 会记录每一个按键操作。做出这样一个修改后再用 . 命令的话，它将会重新执行所有这些按键操作

x 命令会删除光标下的字符
dd 命令也做删除操作
>G 命令会增加从当前行到文档末尾处的缩进层级。

技巧2 不要自我重复
如果你发觉自己正在输入 ko（或更糟糕，在用 k$a<CR>），马上打住！想想你在干什么，然后你就会意识到可以把它换成 O 命令。

复合命令 等效的长命令
C 		 c$
s 		 cl
S 		 ^C
I 		 ^i
A 		 $a
o 		 A<CR>
O 		 ko

技巧 3 以退为进
s 命令把两个操作合并为一个：它先删除光标下的字符，然后进入插入模式。
f{char} 命令让 Vim 查找下一处指定字符出现的位置，如果找到了，就直接把光标移到那里
; 命令会重复查找上次 f 命令所查找的字符，因此不用重复输入 f{char}

技巧 4 执行、重复、回退
在面对重复性工作时，我们需要让移动动作和修改都能够重复，这样就可以达到最佳编辑模式。
目的 操作 重复 回退
做出一个修改 				{edit} 				. u
在行内查找下一指定字符 		f{char}/t{char} 	; ,
在行内查找上一指定字符 		F{char}/T{char} 	; ,
在文档中查找下一处匹配项 	/pattern<CR> 		n N
在文档中查找上一处匹配项 	?pattern<CR> 		n N
执行替换 					:s/target/replacement & u
执行一系列修改 				qx{changes}q 		@x u

技巧 5 查找并手动替换
* 命令，此命令可以查找当前光标下的单词
cw 命令会删除从光标位置到单词结尾间的字符，并进入插入模式。Vim 会把我



## 模式
Vim 提供一个区分模式的用户界面，就是说在 Vim 中按键盘上的任意键所产生的结果可能会不一样，而这取决于当前处于哪种模式（mode）。知道当前正处于哪种模式，以及如何在各模式间切换，是极其重要的。

### 普通模式
技巧 7 停顿时请移开画笔
程序员也只花一小部分时间编写代码。绝大多数时间用来思考、阅读，以及在代码中穿梭浏览，而且当确实需要修改时，谁说一定要切换到插入模式才行？我们可以重新调整已有代码的格式，复制它们，移动其位置，或是删除它们。在普通模式中，我们有众多的工具可以利用。

技巧 8 把撤销单元切成块
Vim 中，我们自己可以控制撤销的粒度。u 键会触发撤销命令，它会撤销最新的修改。i{insert some text}<Esc> 是一次修改。
从进入插入模式开始，直到返回普通模式为止，在此期间输入或删除的任何内容都被当成一次修改。

技巧 9 构造可重复的修改
反向删除，db 命令删除从光标起始位置到单词开头的内容
正向删除，b 命令把光标移到单词的开头，移动好后，就可以用一个 dw 命令删掉整个单词。
删除整个单词，使用更为精准的 aw 文本对象（ text object），把 daw 命令解读为“ delete a word”，来删除整个单词。

技巧 10 用次数做简单的算术运算
大多数普通模式命令可以在执行时指定次数，可以利用这个功能来做简单的算术运算。
<C-a> 和 <C-x> 命令分别对数字执行加和减操作。

技巧 11 能够重复，就别用次数
在处理某些特定工作时，使用次数可以使按键次数变得最少，不过并不是非得这样不可。
删除多个单词时，使用d2w 或 2dw，可以比重复更好，因为你不需要去数重复次数。

技巧 12 双剑合璧，天下无敌
Vim 的强大很大程度上源自操作符与动作命令相结合。
操作符 + 动作命令 = 操作
d{motion} 命令可以对一个字符（ dl）、一个完整单词（ daw）或一整个段落（ dap）进行操作。
Vim 的语法只有一条额外规则，即当一个操作符命令被连续调用两次时，它会作用于当前行。所以 dd 删除当前行，而 >> 缩进当前行。

Vim 的操作符命令
```
c 修改
d 删除
y 复制到寄存器
g~ 反转大小写
gu 转换为小写
gU 转换为大写
gc{motion} 注释
> 增加缩进
< 减小缩进
= 自动缩进
! 使用外部程序过滤{motion}所跨越的行
```

### 插入模式
大部分的 Vim 命令都在非插入模式中执行，不过有些功能在插入模式中会更好实现些。

技巧 13 在插入模式中可即时更正错误
如果在插入模式下撰写文本时出了错，可以立刻对它进行更正，而无需切换模式。可以删除光标前的字符方案：
退格键
<C-h> 删除前一个字符（ 同退格键）
<C-w> 删除前一个单词
<C-u> 删至行首

技巧 14 返回普通模式
插入模式只专注于做一件事，那就是输入文字，而普通模式却是我们大部分时间所使用的模式（顾名思义），因此能快速在这两种模式间切换是很重要的。切换回普通模式的方式：
<Esc> 切换到普通模式
<C-[> 切换到普通模式
<C-o> 切换到插入-普通模式

技巧 15 不离开插入模式，粘贴寄存器中的文本
在插入模式中，可以用 <C-r>{register} 命令很方便地粘贴几个单词。

技巧 16 随时随地做运算
表达式寄存器允许我们做一些运算，并把运算结果直接插入文档中。在插入模式中，输入 <C-r>= 就可以访问这一寄存器。输入表达式后敲一下 <CR>， Vim 就会把执行的结果插入文档的当前位置
了。

技巧 17 用字符编码插入非常用字符
Vim 可以用字符编码（Character Code）插入任意字符。使用此功能可以很方便地输入键盘上找不到的符号。只需在插入模式中输入 <C-v>{code} 即可，其中 {code} 是要插入字符的编码。

技巧 18 用二合字母插入非常用字符
虽然 Vim 允许我们用数字编码插入任意字符，不过这既难记忆也难输入。在插入模式中，只需输入 <C-k>>{char1}{char2} 即可。

技巧 19 用替换模式替换已有文本
在替换模式中输入会替换文档中的已有文本，除此之外，该模式与插入模式完全相同。
用 R 命令可以由普通模式进入替换模式，继续按 <Esc> 键返回普通模式。


### 可视模式
Vim 的可视模式允许选中一块文本区域并在其上进行操作，从表面上看这应该很容易理解，因为大多数编辑软件都沿用此模式。
Vim 具有 3 种不同的可视模式，分别用于操作字符文本、行文本和块文本。

技巧 20 深入理解可视模式
可视模式允许选中一个文本区域并在其上操作。某些可视模式命令执行的基本功能与普通模式相同。

技巧 21 选择高亮选区
激活可视模式
v 激活面向字符的可视模式
V 激活面向行的可视模式
<C-v> 激活面向列块的可视模式
gv 重选上次的高亮选区

在可视模式间切换
<Esc> / <C-[> 回到普通模式
v / V 切换到普通模式（在对应的面向字符可视模式、 面向
<C-v>  行的可视模式和面向列块的可视模式中使用时）
v 切换到面向字符的可视模式
V 切换到面向行的可视模式
<C-v> 切换到面向列块的可视模式
o 切换高亮选区的活动端

切换选区的活动端
高亮选区的范围由其两个端点界定。其中一端固定，另一端可以随光标自由移动，可以用 o 键来切换其活动的端点。